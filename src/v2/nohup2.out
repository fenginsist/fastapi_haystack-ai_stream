INFO:     Will watch for changes in these directories: ['/Users/alsc/Desktop/code/ai_code/fastapi-haystack-stream']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [78601] using WatchFiles
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78608]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
query: 你是谁
top_k: 3
rag 流式返回接口
INFO:     127.0.0.1:51361 - "GET /query-stream?query=%E4%BD%A0%E6%98%AF%E8%B0%81 HTTP/1.1" 200 OK
documents size:  0
--------- all prompt:----------:
 你是谁
您好，我是-------------:您好-------------:，-------------:我是人工智能助手，专门为用户提供-------------:人工智能-------------:助手-------------:，-------------:专门-------------:为-------------:用户提供信息查询、-------------:信息-------------:查询-------------:、问题解答等服务。-------------:问题-------------:解答-------------:等服务-------------:。在这里，-------------:在这里-------------:，我可以帮助您解答语文相关的问题-------------:我可以-------------:帮助-------------:您-------------:解答-------------:语文-------------:相关-------------:的问题，也可以提供学习指导和文学-------------:，-------------:也可以-------------:提供-------------:学习-------------:指导和-------------:文学知识。-------------:知识-------------:。请问-------------:请问有什么可以帮助您的-------------:有什么-------------:可以帮助-------------:您的吗？-------------:吗-------------:？ChatGLM output: {'replies': ['您好，我是人工智能助手，专门为用户提供信息查询、问题解答等服务。在这里，我可以帮助您解答语文相关的问题，也可以提供学习指导和文学知识。请问有什么可以帮助您的吗？'], 'meta': [{'model': 'glm-4-flash', 'index': 0, 'finish_reason': 'stop', 'usage': {}}]}
-------------:-------------:NoneStream ended.
WARNING:  WatchFiles detected changes in 'web.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78608]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78642]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78642]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78652]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78652]
WARNING:  WatchFiles detected changes in 'web2.py'. Reloading...
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78662]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78662]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78664]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2 copy.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78664]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78668]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2 copy.py', 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78668]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78673]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78673]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78692]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78692]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78722]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78722]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [78991]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [78991]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79001]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79001]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79007]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79007]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79019]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79019]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79036]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79036]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79050]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79050]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79172]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79172]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79430]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79430]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79456]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79456]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79462]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79462]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79660]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79660]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79683]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79683]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79714]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79714]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79749]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web3.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79749]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79756]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'web.py', 'src/version/web.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79756]
document size: 3
All documents were successfully written to the document store.
INFO:     Started server process [79772]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/v2/web2.py', 'web2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79772]
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v3/web3.py', 'web3.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web3.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web3.py', 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/ChatGLM.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/ChatGLM.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/ChatGLM.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/db.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/db.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/documentToPrompt.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/chatGLM.py', 'src/v4/ChatGLM.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/chatglm.py', 'src/v4/chatGLM.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/__init__.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/__init__.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/documentToPrompt.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v4/web4.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v5/chatglm.py', 'src/v5/web4.py', 'src/v5/documentToPrompt.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
WARNING:  WatchFiles detected changes in 'src/v5/web4.py', 'src/v5/web5.py'. Reloading...
ERROR:    Error loading ASGI app. Could not import module "web2".
